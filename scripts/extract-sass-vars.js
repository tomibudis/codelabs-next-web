import fs from "fs";

import { each, camelCase } from "lodash";
import { render } from "sass-extract";

const buildColors = async () => {
  const src = [
    `// DO NOT EDIT THIS FILE DIRECTLY, IT IS\n`,
    "// AUTOGENERATED BY /scripts/extract-sass-vars.js\n",
    "export const colors = {\n",
  ];

  const { vars } = await render({
    file: "./src/styles/colors.scss",
  });

  each(vars.global, ({ type, value }, name) => {
    if (type === "SassColor") {
      src.push(`  ${camelCase(name)}: "${value.hex}",\n`);
    }
  });

  src.push("};\n\nexport default colors;\n");

  return src.join("");
};

buildColors().then((colors) => {
  fs.writeFileSync("./src/constants/colors.ts", colors, "utf-8");
});
